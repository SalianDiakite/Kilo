{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Projet-01/projet-perso/Kilo/lib/db/notifications.ts"],"sourcesContent":["import { createClient } from \"@/lib/supabase/client\"\r\nimport type { DbNotification, DbNotificationInsert } from \"./types\"\r\n\r\nexport async function getNotifications(userId: string, limit = 50) {\r\n  const supabase = createClient()\r\n  const { data, error } = await supabase\r\n    .from(\"notifications\")\r\n    .select(\"*\")\r\n    .eq(\"user_id\", userId)\r\n    .order(\"created_at\", { ascending: false })\r\n    .limit(limit)\r\n\r\n  if (error) throw error\r\n  return data as DbNotification[]\r\n}\r\n\r\nexport async function getUnreadNotificationsCount(userId: string) {\r\n  const supabase = createClient()\r\n  const { count, error } = await supabase\r\n    .from(\"notifications\")\r\n    .select(\"*\", { count: \"exact\", head: true })\r\n    .eq(\"user_id\", userId)\r\n    .eq(\"read\", false)\r\n\r\n  if (error) throw error\r\n  return count || 0\r\n}\r\n\r\nexport async function markNotificationAsRead(notificationId: string) {\r\n  const supabase = createClient()\r\n  const { error } = await supabase.from(\"notifications\").update({ read: true }).eq(\"id\", notificationId)\r\n\r\n  if (error) throw error\r\n}\r\n\r\nexport async function markAllNotificationsAsRead(userId: string) {\r\n  const supabase = createClient()\r\n  const { error } = await supabase.from(\"notifications\").update({ read: true }).eq(\"user_id\", userId).eq(\"read\", false)\r\n\r\n  if (error) throw error\r\n}\r\n\r\nexport async function deleteNotification(notificationId: string) {\r\n  const supabase = createClient()\r\n  const { error } = await supabase.from(\"notifications\").delete().eq(\"id\", notificationId)\r\n\r\n  if (error) throw error\r\n}\r\n\r\nexport async function createNotification(notification: DbNotificationInsert) {\r\n  const supabase = createClient()\r\n  const { data, error } = await supabase.from(\"notifications\").insert(notification).select().single()\r\n\r\n  if (error) throw error\r\n  return data as DbNotification\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;AAGO,eAAe,iBAAiB,MAAc,EAAE,QAAQ,EAAE;IAC/D,MAAM,WAAW,IAAA,yIAAY;IAC7B,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,iBACL,MAAM,CAAC,KACP,EAAE,CAAC,WAAW,QACd,KAAK,CAAC,cAAc;QAAE,WAAW;IAAM,GACvC,KAAK,CAAC;IAET,IAAI,OAAO,MAAM;IACjB,OAAO;AACT;AAEO,eAAe,4BAA4B,MAAc;IAC9D,MAAM,WAAW,IAAA,yIAAY;IAC7B,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,MAAM,SAC5B,IAAI,CAAC,iBACL,MAAM,CAAC,KAAK;QAAE,OAAO;QAAS,MAAM;IAAK,GACzC,EAAE,CAAC,WAAW,QACd,EAAE,CAAC,QAAQ;IAEd,IAAI,OAAO,MAAM;IACjB,OAAO,SAAS;AAClB;AAEO,eAAe,uBAAuB,cAAsB;IACjE,MAAM,WAAW,IAAA,yIAAY;IAC7B,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,iBAAiB,MAAM,CAAC;QAAE,MAAM;IAAK,GAAG,EAAE,CAAC,MAAM;IAEvF,IAAI,OAAO,MAAM;AACnB;AAEO,eAAe,2BAA2B,MAAc;IAC7D,MAAM,WAAW,IAAA,yIAAY;IAC7B,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,iBAAiB,MAAM,CAAC;QAAE,MAAM;IAAK,GAAG,EAAE,CAAC,WAAW,QAAQ,EAAE,CAAC,QAAQ;IAE/G,IAAI,OAAO,MAAM;AACnB;AAEO,eAAe,mBAAmB,cAAsB;IAC7D,MAAM,WAAW,IAAA,yIAAY;IAC7B,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,iBAAiB,MAAM,GAAG,EAAE,CAAC,MAAM;IAEzE,IAAI,OAAO,MAAM;AACnB;AAEO,eAAe,mBAAmB,YAAkC;IACzE,MAAM,WAAW,IAAA,yIAAY;IAC7B,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,iBAAiB,MAAM,CAAC,cAAc,MAAM,GAAG,MAAM;IAEjG,IAAI,OAAO,MAAM;IACjB,OAAO;AACT"}}]
}